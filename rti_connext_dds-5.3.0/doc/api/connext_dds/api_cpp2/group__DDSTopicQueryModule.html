<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RTI Connext Modern C++ API: Topic Queries</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RTI Connext Modern C++ API
   &#160;<span id="projectnumber">Version 5.3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2-20120808 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__DDSTopicQueryModule.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Topic Queries</div>  </div>
<div class="ingroups"><a class="el" href="group__DDSReaderModule.html">DataReaders</a></div></div><!--header-->
<div class="contents">

<p><a class="el" href="classrti_1_1sub_1_1TopicQuery.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;reference-type&gt;&gt; Allows a dds::sub::DataReader to query the sample cache of its match...">rti::sub::TopicQuery</a> and associated elements.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrti_1_1sub_1_1TopicQuerySelection.html">rti::sub::TopicQuerySelection</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><em><a class="el" href="group__DDSCpp2Conventions.html#a_st_ext">&lt;&lt;extension&gt;&gt;</a></em> <em><a class="el" href="group__DDSCpp2Conventions.html#a_st_value_type">&lt;&lt;value-type&gt;&gt;</a></em> Specifies the data query that defines a <a class="el" href="classrti_1_1sub_1_1TopicQuery.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;reference-type&gt;&gt; Allows a dds::sub::DataReader to query the sample cache of its match...">TopicQuery</a>.  <a href="classrti_1_1sub_1_1TopicQuerySelection.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrti_1_1sub_1_1TopicQueryData.html">rti::sub::TopicQueryData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><em><a class="el" href="group__DDSCpp2Conventions.html#a_st_ext">&lt;&lt;extension&gt;&gt;</a></em> <em><a class="el" href="group__DDSCpp2Conventions.html#a_st_value_type">&lt;&lt;value-type&gt;&gt;</a></em> Provides information about a <a class="el" href="classrti_1_1sub_1_1TopicQuery.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;reference-type&gt;&gt; Allows a dds::sub::DataReader to query the sample cache of its match...">TopicQuery</a>  <a href="classrti_1_1sub_1_1TopicQueryData.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrti_1_1sub_1_1TopicQuery.html">rti::sub::TopicQuery</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><em><a class="el" href="group__DDSCpp2Conventions.html#a_st_ext">&lt;&lt;extension&gt;&gt;</a></em> <em><a class="el" href="group__DDSCpp2Conventions.html#a_st_ref_type">&lt;&lt;reference-type&gt;&gt;</a></em> Allows a <a class="el" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader</a> to query the sample cache of its matching dds::pub::DataWriters.  <a href="classrti_1_1sub_1_1TopicQuery.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<p><a class="el" href="classrti_1_1sub_1_1TopicQuery.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;reference-type&gt;&gt; Allows a dds::sub::DataReader to query the sample cache of its match...">rti::sub::TopicQuery</a> and associated elements. </p>
<p>TopicQueries allow a <a class="el" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader</a> to query the sample cache of its matching <a class="el" href="classdds_1_1pub_1_1DataWriter.html" title="&lt;&lt;reference-type&gt;&gt; Allows an application to publish data for a dds::topic::Topic">dds::pub::DataWriter</a>. When the application creates a TopicQuery, DDS will propagate it to other DomainParticipants and their DataWriters. When a DataWriter matching with the DataReader that created the TopicQuery receives it, it will send the cached samples that pass the TopicQuery's filter.</p>
<p>To configure how to dispatch a TopicQuery, the <a class="el" href="classdds_1_1pub_1_1qos_1_1DataWriterQos.html" title="&lt;&lt;value-type&gt;&gt; Container of the QoS policies that a dds::pub::DataWriter supports">dds::pub::qos::DataWriterQos</a> includes the <a class="el" href="classrti_1_1core_1_1policy_1_1TopicQueryDispatch.html" title="&lt;&lt;extension&gt;&gt; Configures the ability of a dds::pub::DataWriter to publish samples in response to a rt...">rti::core::policy::TopicQueryDispatch</a> policy. By default, a DataWriter ignores TopicQueries unless they are explicitly enabled using this policy.</p>
<p>The delivery of TopicQuery samples occurs in a separate RTPS channel. This allows DataReaders to receive TopicQuery samples and live samples in parallel. This is a key difference with respect to the Durability QoS policy.</p>
<p>Late-joining DataWriters will also discover existing TopicQueries.</p>
<p>After deleting a TopicQuery, new DataWriters won't discover it and existing DataWriters currently publishing cached samples may stop before delivering all of them. See <a class="el" href="classrti_1_1sub_1_1TopicQuery.html#abc652fa7e6b217d2bf013ee2f131965b" title="Deletes and cancels this TopicQuery.">rti::sub::TopicQuery::close()</a>.</p>
<p>The samples received in response to a TopicQuery are stored in the associated DataReader's cache. Any of the read/take operations can retrieve TopicQuery samples. The field <a class="el" href="classdds_1_1sub_1_1SampleInfo.html#aba34fe0dafa9ec9e95307aa518831e84" title="&lt;&lt;extension&gt;&gt; The GUID of the rti::sub::TopicQuery that is related to the sample.">dds::sub::SampleInfo::topic_query_guid</a> associates each sample to its TopicQuery. If the read sample is not in response to a TopicQuery then this field will be <a class="el" href="classrti_1_1core_1_1Guid.html#ad13643a79d87cb8f0c839f4617f987f5" title="Unknown GUID.">rti::core::Guid::unknown()</a>.</p>
<p>You can choose to read or take only TopicQuery samples, only live samples, or both. To support this ReadConditions and QueryConditions provide the dds::sub::DataReader::create_querycondition_w_params and dds::sub::DataReader::create_readcondition_w_params APIs.</p>
<p>Each TopicQuery is identified by a GUID that can be accessed using the <a class="el" href="classrti_1_1sub_1_1TopicQuery.html#abbe01b664ed1e285a7296538629057d2" title="Gets the TopicQuery GUID.">rti::sub::TopicQuery::guid</a> method.</p>
<h1><a class="anchor" id="DebuggingTopicQueries"></a>
Debugging Topic Queries</h1>
<p>There are a number of ways in which to gain more insight into what is happening in an application that is creating Topic Queries.</p>
<h2><a class="anchor" id="ServiceRequestBuiltinReader"></a>
The Built-in ServiceRequest DataReader</h2>
<p>TopicQueries are communicated to publishing applications through a built-in <a class="el" href="classrti_1_1topic_1_1ServiceRequest.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;value-type&gt;&gt; A request coming from one of the built-in services">rti::topic::ServiceRequest</a> channel. The ServiceRequest channel is designed to be generic so that it can be used for many different purposes, one of which is TopicQueries.</p>
<p>When a DataReader creates a TopicQuery, a <a class="el" href="classrti_1_1topic_1_1ServiceRequest.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;value-type&gt;&gt; A request coming from one of the built-in services">rti::topic::ServiceRequest</a> message is sent containing the TopicQuery information. Just as there are built-in DataReaders for <a class="el" href="classdds_1_1topic_1_1ParticipantBuiltinTopicData.html" title="Entry created when a dds::domain::DomainParticipant is discovered.">dds::topic::ParticipantBuiltinTopicData</a>, <a class="el" href="classdds_1_1topic_1_1SubscriptionBuiltinTopicData.html" title="Entry created when a dds::sub::DataReader is discovered in association with its dds::sub::Subscriber...">dds::topic::SubscriptionBuiltinTopicData</a>, and <a class="el" href="classdds_1_1topic_1_1PublicationBuiltinTopicData.html" title="Entry created when a dds::pub::DataWriter is discovered in association with its dds::pub::Publisher.">dds::topic::PublicationBuiltinTopicData</a>, there is a fourth built-in DataReader for ServiceRequests.</p>
<p>The new built-in DataReader can be retrieved using the built-in subscriber and dds::sub::Subscriber::lookup_datareader. The topic name is <a class="el" href="group__DDSServiceRequestBuiltInTopicModule.html#ga2392be9fb6b4c5251d7ed33f6ebfb902" title="ServiceRequest built-in topic name.">rti::topic::service_request_topic_name()</a>. Installing a listener with the <a class="el" href="classdds_1_1sub_1_1DataReaderListener.html#a24101fc5d0e896dcedfc97455c766df0" title="Called when one or more new data samples have been received.">dds::sub::DataReaderListener::on_data_available</a> callback implemented will allow a publishing application to be notified whenever a TopicQuery has been received from a subscribing application.</p>
<p>The <a class="el" href="classrti_1_1topic_1_1ServiceRequest.html#afbec30ad73e6ca4316ec1cc2011873d0" title="Get the service id of the request.">rti::topic::ServiceRequest::service_id</a> of a <a class="el" href="classrti_1_1topic_1_1ServiceRequest.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;value-type&gt;&gt; A request coming from one of the built-in services">rti::topic::ServiceRequest</a> corresponding to a <a class="el" href="classrti_1_1sub_1_1TopicQuery.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;reference-type&gt;&gt; Allows a dds::sub::DataReader to query the sample cache of its match...">rti::sub::TopicQuery</a> will be <a class="el" href="structrti_1_1core_1_1ServiceRequestId__def.html#a38971f519bdb4f224f77e5f431f7dae3a70588c612dc16c624ad02d6ccf5503a3" title="The topic query service.">rti::core::ServiceRequestId_def::TOPIC_QUERY</a> and the <a class="el" href="classrti_1_1topic_1_1ServiceRequest.html#a559e0979321774f7d5b29536092e9347" title="Get the instance id of the request.">rti::topic::ServiceRequest::instance_id</a> will be equal to the GUID of the <a class="el" href="classrti_1_1sub_1_1TopicQuery.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;reference-type&gt;&gt; Allows a dds::sub::DataReader to query the sample cache of its match...">rti::sub::TopicQuery</a> (see <a class="el" href="classrti_1_1sub_1_1TopicQuery.html#abbe01b664ed1e285a7296538629057d2" title="Gets the TopicQuery GUID.">rti::sub::TopicQuery::guid</a>).</p>
<p>The <a class="el" href="classrti_1_1topic_1_1ServiceRequest.html#acb75be52bb962ccf5e2ad6191cbd76eb" title="Get the request body of the request.">rti::topic::ServiceRequest::request_body</a> is a sequence of bytes containing more information about the TopcQuery. This information can be retrieved using the <a class="el" href="namespacerti_1_1sub.html#aea93d69fa1baa368a2ca209882220ecb" title="Creates a TopicQueryData from a ServiceRequest.">rti::sub::create_topic_query_data_from_service_request()</a> function. The resulting <a class="el" href="classrti_1_1sub_1_1TopicQueryData.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;value-type&gt;&gt; Provides information about a TopicQuery">rti::sub::TopicQueryData</a> contains the <a class="el" href="classrti_1_1sub_1_1TopicQuerySelection.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;value-type&gt;&gt; Specifies the data query that defines a TopicQuery.">rti::sub::TopicQuerySelection</a> that the <a class="el" href="classrti_1_1sub_1_1TopicQuery.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;reference-type&gt;&gt; Allows a dds::sub::DataReader to query the sample cache of its match...">rti::sub::TopicQuery</a> was created with, the GUID of the original DataReader that created the TopicQuery, and the topic name of that DataReader. Note: When TopicQueries are propagated through one or more Routing Services, the last DataReader that issued the TopicQuery will be a Routing Service DataReader. The <a class="el" href="classrti_1_1sub_1_1TopicQueryData.html#adf296ae2c11a6a3353a27a77024397ac" title="Identifies the dds::sub::DataReader that created the rti::sub::TopicQuery.">rti::sub::TopicQueryData::original_related_reader_guid</a>, however, will be that of the first DataReader to have created the TopicQuery.</p>
<h2><a class="anchor" id="NewServiceRequestAcceptedListener"></a>
The on_service_request_accepted DataWriter Listener Callback</h2>
<p>It is possible that a <a class="el" href="classrti_1_1topic_1_1ServiceRequest.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;value-type&gt;&gt; A request coming from one of the built-in services">rti::topic::ServiceRequest</a> for a <a class="el" href="classrti_1_1sub_1_1TopicQuery.html" title="&lt;&lt;extension&gt;&gt; &lt;&lt;reference-type&gt;&gt; Allows a dds::sub::DataReader to query the sample cache of its match...">rti::sub::TopicQuery</a> is received but is not immediately dispatched to a DataWriter. This can happen, for example, if a DataWriter was not matching with a DataReader at the time that the TopicQuery was received by the publishing application. The <a class="el" href="classdds_1_1pub_1_1DataWriterListener.html#ab855441861e0661a9c17427b31d3b3fd" title="&lt;&lt;extension&gt;&gt; Called when a sample that has been received on a the built-in service channel is intend...">dds::pub::DataWriterListener::on_service_request_accepted</a> callback notifies a DataWriter when a ServiceRequest has been dispatched to that DataWriter. The dds::core::status::ServiceRequestAcceptedStatus provides information about how many ServiceRequests have been accepted by the DataWriter since the last time that the status was read. The status also includes the dds::core::status::ServiceRequestAcceptedStatus::last_request_handle, which is the <a class="el" href="classdds_1_1core_1_1InstanceHandle.html" title="&lt;&lt;value-type&gt;&gt; Handle to identiy different instances of the same dds::topic::Topic of a certain type...">dds::core::InstanceHandle</a> of the last ServiceRequest that was accepted. This instance handle can be used to read samples per instance from the built-in ServiceRequest DataReader and correlate which ServiceRequests have been dispatched to which DataWriters.</p>
<h2><a class="anchor" id="ReadingTopicQuerySamples"></a>
Reading TopicQuery Samples</h2>
<p>Data samples that are received by a DataReader in response to a TopicQuery can be identified with two pieces of information from the corresponding <a class="el" href="classdds_1_1sub_1_1SampleInfo.html" title="&lt;&lt;value-type&gt;&gt; Information that accompanies each sample received by a DataReader">dds::sub::SampleInfo</a> to the sample. First, if the <a class="el" href="classdds_1_1sub_1_1SampleInfo.html#aba34fe0dafa9ec9e95307aa518831e84" title="&lt;&lt;extension&gt;&gt; The GUID of the rti::sub::TopicQuery that is related to the sample.">dds::sub::SampleInfo::topic_query_guid</a> is not equal to <a class="el" href="classrti_1_1core_1_1Guid.html#ad13643a79d87cb8f0c839f4617f987f5" title="Unknown GUID.">rti::core::Guid::unknown()</a> then the sample is in response to the TopicQuery with that GUID (see <a class="el" href="classrti_1_1sub_1_1TopicQuery.html#abbe01b664ed1e285a7296538629057d2" title="Gets the TopicQuery GUID.">rti::sub::TopicQuery::guid</a>). Second, if the sample is in response to a TopicQuery and the <a class="el" href="classdds_1_1sub_1_1SampleInfo.html#ae85f8bc9194c560d6d2dedd65a28be45" title="&lt;&lt;extension&gt;&gt; Flags associated with the sample.">dds::sub::SampleInfo::flag</a> SampleFlagBits::INTERMEDIATE_TOPIC_QUERY_SAMPLE flag is set then this is not the last sample in response to the TopicQuery for a DataWriter identified by <a class="el" href="classdds_1_1sub_1_1SampleInfo.html#a12072c6ffa309d44e10201f9ec125ac8" title="&lt;&lt;extension&gt;&gt; The original publication virtual GUID.">dds::sub::SampleInfo::original_publication_virtual_guid</a>. If that flag is not set then there will be no more samples corresponding to that TopicQuery coming from the DataWriter. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<HR>
<IMG SRC="rti_logo.gif" height="16">
<A HREF="main.html">RTI Connext Modern C++ API Version 5.3.0</A>
Copyright &copy; Sun Jun 25 2017 
<A HREF="http://www.rti.com">Real-Time Innovations, Inc</A>
</BODY>
</HTML>
